!function(window,factory){var globalInstall=function(){factory(window.lazySizes),window.removeEventListener("lazyunveilread",globalInstall,!0)};factory=factory.bind(null,window,window.document),"object"==typeof module&&module.exports?factory(require("lazysizes")):"function"==typeof define&&define.amd?define(["lazysizes"],factory):window.lazySizes?globalInstall():window.addEventListener("lazyunveilread",globalInstall,!0)}(window,(function(window,document,lazySizes){"use strict";if(window.addEventListener){var lazySizesCfg=lazySizes.cfg,regWhite=/\s+/g,regSplitSet=/\s*\|\s+|\s+\|\s*/g,regSource=/^(.+?)(?:\s+\[\s*(.+?)\s*\])(?:\s+\[\s*(.+?)\s*\])?$/,regType=/^\s*\(*\s*type\s*:\s*(.+?)\s*\)*\s*$/,regBgUrlEscape=/\(|\)|'/,allowedBackgroundSize={contain:1,cover:1},proxyWidth=function(elem){var width=lazySizes.gW(elem,elem.parentNode);return(!elem._lazysizesWidth||width>elem._lazysizesWidth)&&(elem._lazysizesWidth=width),elem._lazysizesWidth},getBgSize=function(elem){var bgSize;return bgSize=(getComputedStyle(elem)||{getPropertyValue:function(){}}).getPropertyValue("background-size"),!allowedBackgroundSize[bgSize]&&allowedBackgroundSize[elem.style.backgroundSize]&&(bgSize=elem.style.backgroundSize),bgSize},setTypeOrMedia=function(source,match){if(match){var typeMatch=match.match(regType);typeMatch&&typeMatch[1]?source.setAttribute("type",typeMatch[1]):source.setAttribute("media",lazySizesCfg.customMedia[match]||match)}},createPicture=function(sets,elem,img){var picture=document.createElement("picture"),sizes=elem.getAttribute(lazySizesCfg.sizesAttr),ratio=elem.getAttribute("data-ratio"),optimumx=elem.getAttribute("data-optimumx");elem._lazybgset&&elem._lazybgset.parentNode==elem&&elem.removeChild(elem._lazybgset),Object.defineProperty(img,"_lazybgset",{value:elem,writable:!0}),Object.defineProperty(elem,"_lazybgset",{value:picture,writable:!0}),sets=sets.replace(regWhite," ").split(regSplitSet),picture.style.display="none",img.className=lazySizesCfg.lazyClass,1!=sets.length||sizes||(sizes="auto"),sets.forEach((function(set){var match,source=document.createElement("source");sizes&&"auto"!=sizes&&source.setAttribute("sizes",sizes),(match=set.match(regSource))?(source.setAttribute(lazySizesCfg.srcsetAttr,match[1]),setTypeOrMedia(source,match[2]),setTypeOrMedia(source,match[3])):source.setAttribute(lazySizesCfg.srcsetAttr,set),picture.appendChild(source)})),sizes&&(img.setAttribute(lazySizesCfg.sizesAttr,sizes),elem.removeAttribute(lazySizesCfg.sizesAttr),elem.removeAttribute("sizes")),optimumx&&img.setAttribute("data-optimumx",optimumx),ratio&&img.setAttribute("data-ratio",ratio),picture.appendChild(img),elem.appendChild(picture)},proxyLoad=function(e){if(e.target._lazybgset){var image=e.target,elem=image._lazybgset,bg=image.currentSrc||image.src;if(bg){var useSrc=regBgUrlEscape.test(bg)?JSON.stringify(bg):bg,event=lazySizes.fire(elem,"bgsetproxy",{src:bg,useSrc:useSrc,fullSrc:null});event.defaultPrevented||(elem.style.backgroundImage=event.detail.fullSrc||"url("+event.detail.useSrc+")")}image._lazybgsetLoading&&(lazySizes.fire(elem,"_lazyloaded",{},!1,!0),delete image._lazybgsetLoading)}};addEventListener("lazybeforeunveil",(function(e){var set,image,elem;!e.defaultPrevented&&(set=e.target.getAttribute("data-bgset"))&&(elem=e.target,(image=document.createElement("img")).alt="",image._lazybgsetLoading=!0,e.detail.firesLoad=!0,createPicture(set,elem,image),setTimeout((function(){lazySizes.loader.unveil(image),lazySizes.rAF((function(){lazySizes.fire(image,"_lazyloaded",{},!0,!0),image.complete&&proxyLoad({target:image})}))})))})),document.addEventListener("load",proxyLoad,!0),window.addEventListener("lazybeforesizes",(function(e){if(e.detail.instance==lazySizes&&e.target._lazybgset&&e.detail.dataAttr){var elem=e.target._lazybgset,bgSize=getBgSize(elem);allowedBackgroundSize[bgSize]&&(e.target._lazysizesParentFit=bgSize,lazySizes.rAF((function(){e.target.setAttribute("data-parent-fit",bgSize),e.target._lazysizesParentFit&&delete e.target._lazysizesParentFit})))}}),!0),document.documentElement.addEventListener("lazybeforesizes",(function(e){!e.defaultPrevented&&e.target._lazybgset&&e.detail.instance==lazySizes&&(e.detail.width=proxyWidth(e.target._lazybgset))}))}}));